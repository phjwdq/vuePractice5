<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>14单一事件中心管理组件通信</title>
</head>
<body>
	<div id="box">
		<com-a></com-a>
		<com-b></com-b>
		<com-c></com-c>
	</div>
</body>
<script type="text/javascript" src="js/vue2.js"></script>
<script type="text/javascript">
// 创建空的实例
	var Event = new Vue();

	var A = {
		template:'<div><strong>{{str}}</strong><span>{{msg}}</span><input type="button" value="把数据A给C" @click="send()"/></div>',
		data(){
			return {
				str:'这是组件A',
				msg:'这是数据A'
			}
		},
		methods:{
			send(){
				Event.$emit('a-data',this.msg)
			}
		}
	}

	var B = {
		template:'<div><strong>{{str}}</strong><span>{{msg}}</span><input type="button" value="把数据B给C" @click="send()"/></div>',
		data(){
			return {
				str:'这是组件B',
				msg:'这是数据B'
			}
		},
		methods:{
			send(){
				Event.$emit('b-data',this.msg);
			}
		}
	}

	var C = {
		template:'<div><strong>这是组件C</strong><br /><span>接收的A数据是:{{msg1}}</span><br /><span>接收的A数据是:{{msg2}}</span></div>',
		data(){
			return {
				msg1:'',
				msg2:''
			}
		},
		mounted(){
			// 注意：this!!
			// alert(this);
			// console.log(this);
			Event.$on('a-data',function(s){
				this.msg1 = s;
			}.bind(this));
			
			Event.$on('b-data',function(s){
				this.msg2 = s;
			}.bind(this));
		}
	}

	window.onload = function(){
		var vm = new Vue({
			el:'#box',
			components:{
				'com-a':A,
				'com-b':B,
				'com-c':C
			}
		});
		console.log('vm',vm);
	};
</script>
</html>